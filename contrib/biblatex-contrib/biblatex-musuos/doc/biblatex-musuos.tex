\documentclass{ltxdoc}

\usepackage[T1]{fontenc}
\usepackage[latin1]{inputenc}
\usepackage[ngerman]{babel}
\usepackage{xspace}
\usepackage{lmodern} 
\usepackage[hang]{footmisc}
\usepackage{dblfnote}
  \setlength{\footnotemargin}{1em}
\usepackage{scrbase}
\usepackage[hyphens]{url}
\usepackage[style=musuos]{biblatex}
	\bibliography{musuos-bsp.bib}
	\defbibheading{primaer}{\subsection{Primärlitaratur}}
	\defbibheading{sekundaer}{\subsection{Sekundärlitaratur}}
	\defbibheading{online}{\subsection{Internetquellen}}
	\defbibheading{noten}{\subsection{Notentexte}}
	\defbibnote{inet}{Entschuldigung, dass ich nicht nur Bücher verwendet habe.}
\usepackage{csquotes}
\usepackage{hyperref}

\newcommand{\musuos}{\texttt{musuos.cls}\xspace}
\newcommand{\bmusuos}{\texttt{biblatex-musuos}\xspace}
\newcommand*{\pkg}[1]{\texttt{#1}}
\newcommand*{\Opt}[1]{\texttt{#1}\marginpar{\raggedleft\texttt{#1} \small(Opt.)}}
\MakeShortVerb{\|}
\newcommand{\DM}[1]{\DescribeMacro{#1}}
\setcounter{tocdepth}{1}
\setcounter{secnumdepth}{1}

\newcommand{\eintrag}[7][]{%
	\subsection{#2}
	Für #2 sollte der Eintragstyp \texttt{@\uppercase{#3}}%
	\marginpar{\raggedleft\texttt{@\uppercase{#3}}} verwendet werden.
	Er hat die obligatorischen Felder \texttt{\textit{Zitierschlüssel}, #4}%
%	und	die optionalen Felder \texttt{#5}
	. #1\par\medskip\noindent\textbf{Beispiel:}\nopagebreak\par\noindent%
	{\ttfamily @\uppercase{#3}\{\textit{Schlüssel},\\%
	\hspace*{\parindent}\parbox{\textwidth}{#6}\\\}}\par\medskip\noindent%
	\textbf{Ergebnis:}\nopagebreak\\
	\fullcite{#7}.
}



\RecordChanges

\def\generalname{G}
\GlossaryPrologue{
  \section{Versionsgeschichte}
  Die Einträge, die mit einem G markiert sind, beziehen sich auf
  das ganze Paket.
}

\changes{v1.0}{2011/09/16}{Erste Version}

\begin{document}
\title{\bmusuos}
\author{Tobias Weh\\
\normalsize\href{mailto:mail@tobias-weh.de}{\texttt{mail@tobias-weh.de}}\\
\normalsize\url{www.tobias-weh.de}}
\date{2011/09/16 --- v1.0}

\maketitle

\vfill
\begin{abstract}
\noindent Der \pkg{biblatex}-Stil \bmusuos ist eine Ergänzung zur Klasse \musuos,
kann aber unabhängig davon verwendet werden. Er setzt die Vorgaben
von apl. Prof. Dr. Stefan Hanheide vom Institut für Musik und
Musikwissenschaft der Universität Osnabrück um.
\end{abstract}

\vfill\tableofcontents\vfill\mbox{}\clearpage

\section{Einleitung}
\subsection{Installation}
Zur Installation müssen die Dateien |musuos.bbx|, |musuos.cbx| und |musuos.lbx|
in ein \LaTeX{} bekanntes Verzeichnis kopiert werden, z.\,B. den lokalen |texmf|-Ordner
(\verb|$TEXMFHOME/tex/latex/musuos-biblatex/|).
Um diese Dokumentation zu erzeugen ruft man nacheinander

\smallskip
|pdflatex musuos-biblatex|

|pdflatex musuos-biblatex|

|makeindex -s gglo.ist -o musuos-biblatex.gls musuos-biblatex.glo|

|biblatex musuos-biblatex|

|pdflatex musuos-biblatex|

|pdflatex musuos-biblatex|

\smallskip\noindent%
auf.

\subsection{Verwendung}
Der Stil wird als Option von \pkg{biblatex} geladen:

\smallskip
|\usepackage[style=musuos]{biblatex}|

\smallskip\noindent%
Obwohl Zitat- und Bibliographie-Stile getrennt voneinander geladen werden können,
wird dingend dazu geraten \textbf{immer beide zusammen} zu verwenden! Mit der
Option \Opt{autocite}|=|\meta{Wert} kann die darstellung der Quellen global verändert werden -- natürlich
nur wenn man später auch immer \cmd{\autocite} benutzt. Dieser Option können
folgende Werte geben werden.
\begin{description}
	\item [\texttt{plain}] Alle Zitate werden als Text an der Stelle ausgeben, wo der
		\cmd{\autocite}-Befehl verwendet wurde.
	\item [\texttt{inline}] Wie |plain|, nur das die Quellenangabe in Klammern gesetzt wird.
	\item [\texttt{footnote}] Quellenangaben werden als Fußnoten gesetzt (Voreinstellung).
\end{description}

\begin{macro}{\bibliography}
Die Quelle für alle Litaraturdaten ist eine Datei mit der Endung |.bib|. Sie wird
mit dem Befehl \cmd{\bibliogaphy}\marg{Datei} geladen, bei der Angabe einer \meta{Datei}
kann auf die Endung verzichtet werden.
\end{macro}

\subsection{Danksagung}
Mein Dank gebührt besonders dem Nutzer Audrey von \href{http://tex.stackexchange.com}{TeX.SX}, der
für mich eine Lösung für Sekundärzitate gefunden hat%
\footnote{Der Beitrag findet sich unter \url{http://tex.stackexchange.com/q/27964/4918}.}
und auch vielen anderen
Nutzern dieser Plattform danke ich für Hilfestellungen.

\section{Eintragstypen}
Die Stile unterstützen alle Eintragstypen, die von \pkg{biblatex} bereitgestellt
werden. An dieser Stelle sollen nur die am häufigsten benötigten Dargestellt werden.
Für die anderen Eintragstypen und die Listen der optionalen Felder bzw.
deren Erklärung sei auf die sehr
ausführliche \pkg{biblatex}-Anleitung hingewiesen.%
\footnote{Man beachte, dass die Groß-/Klein"-schrei"-bung der Eintragtypen im Gegensatz zu
\LaTeX-Befehlen im Allgemeinen keine Rolle Spielt. D.\,h. \texttt{@ARTICLE} = \texttt{@article}
= \texttt{@Article} = \texttt{@ArTiClE} = \dots{} Allerdings ist es üblich, die Typen
in Großbuchstaben zu schreiben.}

\eintrag{Zeitschriftenartikel}{article}{author, title, journal, year/date}
{translator, annotator, commentator, subtitle, titleaddon, editor, editora, editorb,
editorc, journalsubtitle, issuetitle, issuesubtitle, language, origlanguage, series,
volume, number, eid, issue, month, pages, version, note, issn, addendum, pubstate,
doi, eprint, eprintclass, eprinttype, url, urldate}{%
	author = \{Peter Müller\},\\
	title = \{Beethovens Streichquartette\},\\
	journal = \{Archiv für Musikwissenschaft\},\\
	volume = \{28\},\\
	year = \{1968\},\\
	pages = \{180-\/-212\}
}{artikel}

\eintrag{Bücher}{book}{author, title, year/date}
{editor, editora, editorb, editorc, translator, annotator, commentator,
introduction, foreword, afterword, subtitle, titleaddon, maintitle,
mainsubtitle, maintitleaddon, language, origlanguage, volume, part,
edition, volumes, series, number, note, publisher, location, isbn,
chapter, pages, pagetotal, addendum, pubstate, doi, eprint, eprintclass,
eprinttype, url, urldate}{%
	author = \{Peter Müller\},\\
	title = \{Beethovens Streichquartette\},\\
	year = \{1983\},\\
	location = \{München\}
}{buch2}

\smallskip\noindent%
Für Bücher die keinen Autor sondern nur einen Herausgeber haben,
kann stattdessen |@BOOKLET| verwendet werden.

\eintrag{Sammelbände}{collection}{editor, title, year/date}
{editora, editorb, editorc, translator, annotator, commentator,
introduction, foreword, afterword, subtitle, titleaddon, maintitle,
mainsubtitle, maintitleaddon, language, origlanguage, volume, part,
edition, volumes, series, number, note, publisher, location, isbn,
chapter, pages, pagetotal, addendum, pubstate, doi, eprint, eprintclass,
eprinttype, url, urldate}{%
	editor = \{Hans Meier\},\\
	title = \{Beethoven Handbuch\},\\
	year = \{1972\},\\
	location = \{Berlin\}
}{sammelb}

\eintrag{Artikel aus Sammelbänden}{incollection}{author, editor, title, booktitle, year/date}
{editora, editorb, editorc, translator, annotator, commentator, introduction, foreword,
afterword, subtitle, titleaddon, maintitle, mainsubtitle, maintitleaddon, booksubtitle,
booktitleaddon, language, origlanguage, volume, part, edition, volumes, series, number,
note, publisher, location, isbn, chapter, pages, addendum, pubstate, doi, eprint,
eprintclass, eprinttype, url, urldate}{%
	author = \{Friedhelm Schmidt\},\\
	title = \{Mozarts Streichquintette\},\\
	booktitle = \{Mozart Jahrbuch\},\\
	editor = \{dems.\},\\
	volume = \{2\},\\
	year = \{2011\},\\
	location = \{Wien\}
}{sammart}

\eintrag{Internet-Quellen}{online}{author/editor, title, year/date, url}
{subtitle, titleaddon, language, version, note,
organization, date, month, year, addendum, pubstate, urldate}{%
	title = \{Neue Musik im Internet\},\\
	author = \{Susi Sorglos\},\\
	year = \{2010\},\\
	url  = \{http://www.susi-sorglos-im-netz.de/neu\_mus\_inet.htm\},\\
	urldate = \{2011-09-10\}
}{internet}

\medskip\noindent%
Wer statt "`am"' lieber "`besucht am"' hätte , kann das durch Einfügen der folgenden Zeile
in die Dokumentenpräambel tun:

\smallskip
|\DefineBibliographyStrings{german}{urlseen = {besucht am}}|

\eintrag[Im Feld \texttt{usera} kann die Opuszahl angeben werden, wird außerdem
\texttt{userb} angeben, wird der Verzeichnistitel statt "`op."' verwendet]{Noten}
{music}{author, title}{usera, userb, editor, series,
location, publisher, year}{%
	author = \{Johann Sebastian Bach\},\\
	title = \{Motetten\},\\
	usera = \{225-\/-230\},\\
	userb = \{BWV\},\\
	editor = \{Konrad Ameln\},\\
	series = \{Neue Bach-Ausgabe Serie III, Band 1\},\\
	location = \{Kassel\},\\
	publisher = \{Bärenreiter\},\\
	year = \{1965\}
}{noten}

\noindent\textbf{Beispiel:}\par\noindent%
	{\ttfamily @\uppercase{music}\{\textit{Schlüssel},\\%
	\hspace*{\parindent}\parbox{\textwidth}{%
	 author = \{Ludwig van Beethoven\},\\
	 title = \{Sinfonie Nr. 3\},\\
	 usera = \{55\}
	}\\\}}\par\medskip\noindent%
	\textbf{Ergebnis:}\\
	\fullcite{noten2}.

\subsection{allgemeine Felder}
Jeder Eintrag kann mit den optionalen Feldern \texttt{url}, \texttt{urldate}
und \texttt{note} versehen werden, um ggf. zusätzliche Informationen
oder eine Internetadresse anzugeben.

\section{Zitatbefehle}
Auch hier werden nur die nötigsten vorgestellt. Eine vollständige Liste findet sich
selbstverständlich in der \pkg{biblatex}-Anleitung.

\begin{macro}{\autocite}
Der Befehl \cmd{\autocite}\oarg{davor}\oarg{danach}\marg{Schlüssel}
ist wohl ausreichend für die allermeisten Quellenangaben.
Im Argument \meta{davor} kann ein Text wie "`vgl."' angeben werden; in \meta{danach}
eine Seitenzahl -- in dem Fall wird "`S."' automatisch ergänzt -- oder ein anderer Text.

\medskip\noindent%
\textbf{Beispiele:}\\
|\autocite{nussb83}| ergibt\\
\fullcite{buch}.\\[0.5em]
|\autocite[7]{nussb83}| ergibt\\
\fullcite[7]{buch}.\\[0.5em]
|\autocite[Vgl.][]{nussb83}| ergibt\\
\fullcite[Vgl.][]{buch}.\\[0.5em]
|\autocite[Vgl.][11--13]{nussb83}| ergibt\\
\fullcite[Vgl.][11--13]{buch}.\\[0.5em]
|\autocite[Vgl.][siehe außerden den Anhang dieser Publikation]{nussb83}| ergibt\\
\fullcite[Vgl.][siehe außerden den Anhang  dieser Publikation]{buch}.
\end{macro}

\begin{macro}{\autocites}
Dieser Befehl dienst dazu, mehrere Quellen anzugeben, er folgt dabei einer ähnlichen Syntax
wie |\autocite|:

\smallskip
|\autocites|\parg{davor}\parg{danach}\oarg{1.1}\oarg{1.2}\marg{1.3} \dots \oarg{n.1}\oarg{n.2}\marg{n.3}

\smallskip\noindent%
Dabei sind die beiden Argumente in runden Klammern optional und nehmen Präfixe und Suffixe auf, die sich
auf die gesamte Angabe beziehen. Die Liste mit Teilen des Schemas \oarg{n.1}\oarg{n.2}\marg{n.3}
nimmt einzelne Quellen auf und kann beliebig lang sein.

\medskip\noindent%
\textbf{Beispiele:}\\
|\autocites{nuss83}{mueller}| ergibt\\
\citereset\cites{buch}{buch2}.\\[0.5em]
|\autocites(Vgl.)(Außerdem ist ...)[7]{nuss}[98]{mueller}[23]{mei72}|\\
\citereset\cites(Vgl.)(Außerdem ist anzumerken, dass alles toll ist.)[7]{buch}[98]{buch2}[23.]{sammelb}
\end{macro}

\begin{macro}{\fullcite}
Mit dem Befehl \cmd{\fullcite} kann ein Vollzitat an beliebiger Stelle eingefügt werden.
Dieser Befehl reagiert nicht auf die |autocite|-Option.
\end{macro}

\subsection{Aussehen der Quellen, Ebenda-Angaben}
Per Voreinstellung erzeugen die \cmd{\autocite}(|s|)-Befehle eine Fußnote mit der entsprechenden
Quellenangabe. Dabei setzt das System bei Bedarf Ebenda-Angaben, sofern sich die Quellen auf der Selben
Seite befinden.

\medskip
\noindent%
\textbf{Beispiel:}\\
Ein Text wie |Text\autocite[7]{nuss83} noch mehr Text\autocite[Vgl.][7]|\\
|{nuss83} und immer\autocite[Vgl.][22]{nuss83} ... Seitenumbruch ...|\\
|noch\autocite[Vgl.][22]{nuss83} mehr Text\autocite[Vgl.][22]{nuss83}.| ergibt dann
die Fußnoten

\smallskip\noindent
\textsuperscript{1} Felix Nussbaum (Hrsg.): \textit{Beethovens Streichquartette}. Kassel, 1983, S. 7.\\
\textsuperscript{2} Vgl. ebd.\\
\textsuperscript{3} Vgl. ebd., S. 22.\\
\hspace*{\parindent}------ Seitenumbruch ------\\
\textsuperscript{4} Vgl. Nussbaum 1983, S. 22.\\
\textsuperscript{5} Vgl. ebd.\\

\section{Beispiel-Literaturverzeichnis}
\begin{macro}{\printbibliography}
Das Litaraturverzeichnis wird mit dem Befehl \cmd{\printbibliography}\oarg{Optionen} ausgeben.
Standardmäßig erhält es eine unnumerierte Überschrift. Wer den Text der Überschrift ändern möchte,
kann das mit der Option |title=|\marg{Überschrift} machen. Eine andere Möglichkeit wird später noch gezeigt.
Standardmäßig werden in die Litartaurliste nur Werke aufgenommen, die auch tatsächlich als Quellen
verwendet worden sind (die also in einem Zitierbefehl vorkommen).
\end{macro}
\begin{macro}{\nocite}
Wer zusätzliche etwas aufnehmen will, verwendet den Befehl \cmd{\nocite}|{|\meta{Schlüssel 1}|,|\meta{Schlüssel 2}|,|\dots|}|.
Um alle Einträge aus der |.bib|-Datei aufzunehmen setzt man statt der Schlüsselliste einen Stern: |\nocite{*}|
\end{macro}

\subsection{geteilte Verzeichnisse}
Um mehrere Verzeichnisse (bspw. eins für Primär- und eines für Sekundärliteratur) zu erzeugen, gibt es
verschiedene Arten von Filtern. Die folgenden Beispiele zeigen einige von ihnen

\begin{itemize}
\item |\printbibliography[nottype=online]\printbiliography[type=online]| erzeugt zwei Verzeichnisse.
	Aus der ersten werden alle Einträge vom Typ |@ONLINE| ausgeschlossen und im zweiten tauchen nur die
	|@ONLINE|-Einträge auf.
\item |\printbibliography[keyword=blub]| erzeugt ein Verzeichnis, in dem nur Einträge enthalten sind,
	die im Feld |keywords| den Text |blub| enthalten.
\item Dagegen filtert |\printbibliography[notkeyword=blub]| alle Einträge aus dem Verzeichnis, die in Feld
	|keywords| den Text |blub| enthalten.
\end{itemize}

Da diese Verzeichnisse aber alle dieselbe Überschrift erhalten, soll noch an einem Beispiel gezeigt werden,
wie man mehrere Verzeichnisse mit verschiedenen Überschriften erzeugt. Für dieses Beispiel nehmen wir
an, dass Primärquellen das Schlüsselwort |primaer| enthalten, alle Internetquellen als |@ONLINE|-Eintrag
und Noten als |@MUSIC|-Eintrag gespeichert sind.%
\footnote{Vergleiche dazu die Datei \texttt{musuos-bsp.bib}.}
Nun müssen wir zunächst Überschriften für die Verschiedenen
Bibliographien definieren; das geschieht vorzugsweise in der Präambel des Dokuments:
\begin{verbatim}
   \defbibheading{primaer}{\subsection{Primärlitaratur}}
   \defbibheading{sekundaer}{\subsection{Sekundärlitaratur}}
   \defbibheading{online}{\subsection{Internetquellen}}
   \defbibheading{noten}{\subsection{Notentexte}}
\end{verbatim}
Für die Internetquellen legen wir außerdem noch einen erläuternden Text an:
\begin{verbatim}
   \defbibnote{inet}{Entschuldigung, dass ich nicht nur Bücher verwendet habe.}
\end{verbatim}
So gerüstet können wir jetzt die Verschiedenen Verzeichnisse ausgeben lassen:
\begin{verbatim}
   \section{Literaturverzeichnis}
   \printbibliography[heading=primaer,keyword=primaer,%
      nottype=online,nottype=music]
   \printbibliography[heading=sekundaer,notkeyword=primaer,%
      nottype=online,nottype=music]
   \printbibliography[heading=online,prenote=online,type=online]
   \printbibliography[heading=noten,type=music]
\end{verbatim}
Das Ergebnis zeigt Abschnitt~\ref{lit-bsp}, dabei wären die |\subsections| natürlich
auch nummeriert, wenn ich das in diesem Dokument nicht global ausgeschaltet hätte.

\section{Sekundärzitate}
\begin{macro}{\quotecite}
Sekundärzitate können mit dem Befehl 

\smallskip
\cmd{\quotecite}\parg{davor}\parg{danach}\oarg{vor Sek.}\oarg{nach Sek.}\marg{Schlüssel Sek.}

\hspace*{\parindent}\oarg{vor Prim.}\oarg{nach Prim.}\marg{Schlüssel Prim.}

\smallskip\noindent%
gesetzt werden, der dann die Quelle als Fußnote ausgibt. Die Argumente verhalten sich
analog zu denen von |\autocites|. In das Literaturverzeichnis werden dann
die Primärquelle und die Sekundärquelle mit dem Zusatz
"`Zit. nach \dots"' aufgenommen. Wer nur die Primärquellen aufnehmen will, verwendet
die Option \Opt{filter=onlyprimary}.

\medskip\noindent%
\textbf{Beispiel:}\\
|\quotecite(Vgl.)()[7]{nuss83}[99]{mei72}|

\medskip\noindent%
\textbf{Ergebnis:}\\
Vgl. Felix Nussbaum (Hrsg.): Beethovens Streichquartette. Kassel, 1983, S. 7.
Zit. nach Hans Meier (Hrsg.): Beethoven Handbuch. Berlin, 1972, S. 99.
\end{macro}

\begin{macro}{\fullquotecite}
In Analogie zu \cmd{\fullcite}, gibt es außerdem
den Befehl \cmd{\fullquotecite}, der immer eine vollständige Quellenangabe erzeugt.
Im Gegensatz zu \cmd{\fullcite} reagiert dieser Befehl aber auf die Option
|autocite|.
\end{macro}

\section{Anmerkungen}

\begin{description}
	\item [Das URL-Datum] sollte im Format \texttt{JJJJ-MM-TT} (bspw. \texttt{2011-09-10})
	angeben werden. Es wird automatisch	richtig umgewandelt. Außerdem kann dadurch das 
	Aussehen einheitlich mit der Option \Opt{urldate} angepasst werden
	(siehe \pkg{biblatex}-Dokumentation, Abschn. 3.1.2, S. 46).
	\item [URL-Darstellung] Wenn eines der Pakete \pkg{hyperref} oder \pkg{url} verwendet
	wird, wird die URL mit dem Befehl |\url|\marg{Adresse} dargestellt, so dass ihr
	Aussehen mir |\urlstyle| (siehe \pkg{url}-Dokumentation) angepasst werden kann.
	
	Wenn das Paket \pkg{url} mit Optionen geladen werden soll, muss es vor \pkg{biblatex}
	geladen werden.
	\item [Zur Verwaltung] der Literaturdatenbank empfehle ich das Programm JabRef
		(\url{http://jabref.sourceforge.net/})
	\item [Zitate in optionalen Argumenten] Wenn ein Zitatbefehl mit optionalen Argumenten
		in einem andern optionalen Argument werdendet werden soll, muss der Befehl durch
		geschweifte Klammern geschützt werden, das \LaTeX{} andernfalls die Schachtelung
		von eckigen Klammern falsch auflöst.
		
		Beispielsweise schreibt man besser |\begin{quote}[{\autocite[3]{nuss83}}]|
		statt |\begin{quote}[\autocite[3]{nuss83}]|.
\end{description}

\section{Literaturverzeichnis}\label{lit-bsp}
\printbibliography[heading=primaer,keyword=primaer,nottype=online,nottype=music]
\printbibliography[heading=sekundaer,notkeyword=primaer,nottype=online,nottype=music]
\printbibliography[heading=online,prenote=inet,type=online]
\printbibliography[heading=noten,type=music]

\PrintChanges
\end{document}