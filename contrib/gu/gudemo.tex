\documentclass[tablecaptionabove]{scrartcl}
\usepackage{amssymb} % Symbole
\usepackage{ifpdf}
\ifpdf
\usepackage[pdftex]{gu}
\else
\usepackage[dvips]{gu}
%\usepackage[dvips,pstarrows]{gu}
\fi

%\setlength{\extrarowheight}{0.1em} % Extraabstand Zellinhalt-Zellrahmen


\usepackage[latin1]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{ngerman}
%\usepackage[german]{babel}
\usepackage{textcomp,lmodern}


\begin{document}

Momentan werden zwei Symmetrieabstiegsschritte unterstützt. Ein schematischer
Stammbaum ist in Abbildung~\ref{abb_schematisch} gezeigt.

\begin{figure}[btp]
\begin{stammbaum}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%  Ab hier die einzelnen Elemente eintragen  %%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Die verschiedenen Elemente, die links gesetzt werden, der Stammbaum
\setuplinks{true}      % Raumgruppe+Summenformel eins: true=Anzeigen, false=Ausblenden
           {2em}    % Mindestlänge Linie/Pfeil1: Muss unbedingt Längeneinheit
	            % sein, zum Ausblenden: 0em oder 0pt etc.
           {true}      % Abstiegssymbol eins: true=Anzeigen, false=Ausblenden
	   {true}      % Raumgruppe+Summenformel zwei: true=Anzeigen, false=Ausblenden
	   {2em}    % Mindestlänge Linie/Pfeil2: Muss unbedingt Längeneinheit
	            % sein, zum Ausblenden: 0em oder 0pt etc.
	   {true}      % Abstiegssymbol zwei: true=Anzeigen, false=Ausblenden 
	   {true}      % Raumgruppe+Summenformel drei: true=Anzeigen, false=Ausblenden 
           {0em}    % zusätzliche Abstände zwischen den Elementen: Muss 
	            % unbedingt Längeneinheit sein


% Die Elemente rechts, die Tabellen mit der Lagenfortführung
\setuprechts{true}     % Lagentabelle eins: true=Anzeigen, false=Ausblenden 
            {2em}   % Pfeile eins Mindestlänge: Muss unbedingt Längeneinheit
	            % sein, zum Ausblenden: 0em oder 0pt etc.
	    {true}     % Transformationsmatrix eins: true=Anzeigen, false=Ausblenden
	    {true}     % Lagentabelle zwei: true=Anzeigen, false=Ausblenden 
	    {4em}   % Pfeile zwei Mindestlänge: Muss unbedingt Längeneinheit
	            % sein, zum Ausblenden: 0em oder 0pt etc.
	    {true}     % Transformationsmatrix zwei: true=Anzeigen, false=Ausblenden
	    {true}     % Lagentabelle drei: true=Anzeigen, false=Ausblenden 
	    {0.5em} % zusätzliche Abstände zwischen den Elementen: Muss 
	            % unbedingt Längeneinheit sein

% Weitere Einstellungen
\setupdivers{2em}     % horizontaler Abstand Stammbaum <--> Lagentabellen
	    {0em}   % Extraabstand für Kollisionskontrolle Pfeile rechts x
	    {0em}   % Extraabstand für Kollisionskontrolle Pfeile rechts y
	    {false}       % Abstieg 1: true=Symbole links und rechts auf gleicher Höhe
	    {false}       % Abstieg 2: true=Symbole links und rechts auf gleicher Höhe
	    {false}       % true=Randbox, false=keine Randbox anzeigen

% Einstellungen, die die Lagentabellen betreffen
\setuprlagentabellen{4.5em}   % Spaltenbreite (Längeneinheit, bei Bedarf anpassen)
                    {2}     % Anzahl Spalten Tabelle 1 (Zahl)
		    {1}     % Anzahl Spalten Tabelle 2 (Zahl)
		    {1}     % Anzahl Spalten Tabelle 3 (Zahl)
{0em}% horizontale Verschiebung Tabelle eins
{0em}% horizontale Verschiebung Tabelle zwei
{0em}% horizontale Verschiebung Tabelle drei

% Raumgruppe und Summenformel eins
\lverbindungeins{%
\fbox{{\Huge lblockeins}}%
}

% Abstiegssymbol eins
\labstiegeins{%
\fbox{lseins}%
}

% Raumgruppe und Summenformel zwei
\lverbindungzwei{%
\fbox{{\tiny lblockzwei}}%
}

% Abstiegssymbol zwei
\labstiegzwei{%
\fbox{lszwei}%
}

% Raumgruppe und Summenformel drei
\lverbindungdrei{%
\fbox{{\Huge lblockdrei}}%
}

% Transformationsmatrix zwischen Tabelle 1 und 2
\rlagentranseins{%
\fbox{rseins}%
}

% Transformationsmatrix zwischen Tabelle 2 und 3
\rlagentranszwei{%
\fbox{rszwei}%
}

% Lagentabelle eins
% Optional Verschiebung in x angeben (Längeneinheit)
% negative Werte funktionieren evtl. noch nicht so 100%
\rlagentabelleeins{%
\fbox{{\tiny rblockeins}}%
}

% Lagentabelle zwei
% Optional Verschiebung in x angeben (Längeneinheit)
% negative Werte funktionieren evtl. noch nicht so 100%
\rlagentabellezwei{%
\fbox{{\Huge rblockzwei}}%
}

% Lagentabelle drei
% Optional Verschiebung in x angeben (Längeneinheit)
% negative Werte funktionieren evtl. noch nicht so 100%
\rlagentabelledrei{%
\fbox{{\tiny rblockdrei}}%
}


% Die Pfeile zwischen den Tabellen
% \rpfeileinszwei{start}{ziel} zeichnet einen Pfeil von Spalte "start" nach
% Spalte "ziel" von Lagentabelle eins nach Lagentabelle zwei
% \rpfeilzweidrei{start}{ziel} zeichnet einen Pfeil von Spalte "start" nach
% Spalte "ziel" von Lagentabelle zwei nach Lagentabelle drei
\rechtspfeilsetup{
\rpfeileinszwei{1}{1}
\rpfeilzweidrei{1}{1}
\rpfeileinszwei{1}{3}
\rpfeilzweidrei{1}{3}



}

\end{stammbaum}
\caption{Allgemeiner schematischer Aufbau der einzelnen Elemente.}
\label{abb_schematisch}
\end{figure}


Abbildung~\ref{abb_einfach} zeigt einen einfachen Stammbaum mit einem
Symmetrieabstieg ohne Lagenfortführung.
\begin{figure}[btp]
\centering
\begin{stammbaum}

\setuplinks%
{true}% Raumgruppe und Summenformel 1
{2em}% Mindestlänge Linie/Pfeil 1
{true}% Abstiegssymbol 1
{true}% Raumgruppe und Summenformel 2
{0em}% Mindestlänge Linie/Pfeil 2
{false}% Abstiegssymbol 2
{false}% Raumgruppe und Summenformel 3
{0em}% zusätzliche vertikale Abstände
   
\setuprechts%
{false}% Lagentabelle 1
{0em}% Mindestlänge Linie/Pfeil 1
{false}% Transformation 1
{false}% Lagentabelle 2
{0em}% Mindestlänge Linie/Pfeil 2
{false}% Transformation 2
{false}% Lagentabelle 3
{0em}% zusätzliche vertikale Abstände

\setupdivers%
{0em}% horizontaler Abstand links <-> rechts
{0em}% Feinabstimmung Kollisionskontrolle x
{0em}% Feinabstimmung Kollisionskontrolle y
{false}% lseins und rseins vertikal zentrieren
{false}% lszwei und rszwei vertikal zentieren
{false}% Randbox zeichnen
      
\setuprlagentabellen%
{0em}% Spaltenbreite
{0}% Anzahl Spalten Tabelle eins
{0}% Anzahl Spalten Tabelle zwei
{0}% Anzahl Spalten Tabelle drei  
{0em}% horizontale Verschiebung Tabelle eins
{0em}% horizontale Verschiebung Tabelle zwei
{0em}% horizontale Verschiebung Tabelle drei

\lverbindungeins{%
\begin{tabular}{c}%
$P6_3/mmc$\\
\fbox{AuSn}\\
\end{tabular}%
}

\labstiegeins{%
t2%
}

\lverbindungzwei{%
\begin{tabular}{c}%
$P\overline{3}m1$\\
\fbox{AuNiSn$_2$}\\
\end{tabular}%
}

\end{stammbaum}

\caption{Einfacher Stammbaum ohne Lagenfortführung.}
\label{abb_einfach}
\end{figure}





Abbildung~\ref{abb_einfach_mit} zeigt einen einfachen Stammbaum mit einem
Symmetrieabstieg mit Lagenfortführung. Dieses Mal werden die Lagentabellen mit
definiert. Zur Demonstration des optionalen Parameters zur Verschiebung der
Tabellen ist die untere Tabelle um \texttt{2em} nach rechts verschoben. 
\begin{figure}[btp]
\centering
\begin{stammbaum}
\setuplinks%
{true}% Raumgruppe und Summenformel 1
{2em}% Mindestlänge Linie/Pfeil 1
{true}% Abstiegssymbol 1
{true}% Raumgruppe und Summenformel 2
{0em}% Mindestlänge Linie/Pfeil 2
{false}% Abstiegssymbol 2
{false}% Raumgruppe und Summenformel 3
{0em}% zusätzliche vertikale Abstände
   
\setuprechts%
{true}% Lagentabelle 1
{2em}% Mindestlänge Linie/Pfeil 1
{false}% Transformation 1
{true}% Lagentabelle 2
{0em}% Mindestlänge Linie/Pfeil 2
{false}% Transformation 2
{false}% Lagentabelle 3
{0.5em}% zusätzliche vertikale Abstände

\setupdivers%
{1em}% horizontaler Abstand links <-> rechts
{0em}% Feinabstimmung Kollisionskontrolle x
{0em}% Feinabstimmung Kollisionskontrolle y
{true}% lseins und rseins vertikal zentrieren
{false}% lszwei und rszwei vertikal zentieren
{false}% Randbox zeichnen
      
\setuprlagentabellen%
{4.5em}% Spaltenbreite
{2}% Anzahl Spalten Tabelle eins
{3}% Anzahl Spalten Tabelle zwei
{0}% Anzahl Spalten Tabelle drei  
{0em}% horizontale Verschiebung Tabelle eins
{2em}% horizontale Verschiebung Tabelle zwei
{0em}% horizontale Verschiebung Tabelle drei


\lverbindungeins{%
\begin{tabular}{c}%
$P6_3/mmc$\\
\fbox{AuSn}\\
\end{tabular}%
}

\labstiegeins{%
t2%
}

\lverbindungzwei{%
\begin{tabular}{c}%
$P\overline{3}m1$\\
\fbox{AuNiSn$_2$}\\
\end{tabular}%
}

\rlagentabelleeins{%
\begin{tabularx}{\spaltenbreiteem*\spalteneins}[b]{|z|z|}
\hline
Au: $2a$ & Sn: $2c$ \\
$\overline{3}m.$ & $\overline{6}m2$ \\
\hline
0 & \ed \\
0 & \zd \\
0 & \ev \\
\hline
\end{tabularx}%
}

\rlagentabellezwei{%
\begin{tabularx}{\spaltenbreiteem*\spaltenzwei}[b]{|z|z|z|}
\hline
Au: $2a$  & Ni: $1b$ & Sn: $2d$ \\
$\overline{3}m.$ & $\overline{3}m.$ & $3m.$ \\
\hline
0 & 0 & \ed \\
0 & 0 & \zd \\
0 & \eh & 0.2831 \\
\hline
\end{tabularx}%
}

\rechtspfeilsetup{%
\rpfeileinszwei{1}{1}
\rpfeileinszwei{1}{2}
\rpfeileinszwei{2}{3}
}
\end{stammbaum}
\caption{Einfacher Stammbaum mit Lagenfortführung.}
\label{abb_einfach_mit}
\end{figure}



Abbildung~\ref{abb_mit_aufw} zeigt einen etwas aufwändigeren Stammbaum
mit zwei Symmetrieabbaustufen und Lagenfortführung. Außerdem wird die
Möglichkeit der Angabe einer Lagentransformation demonstriert, auch wenn sie in
diesem Beispiel kristallographisch gesehen sinnfrei ist. Die Pfeile rechts
werden gegebenenfalls durchbrochen, wenn sie den Text der Lagentransformation
schneiden würden. Die virtuelle Box um den Text der Lagentransformation (rseins,
rszwei), die benutzt wird, um zu bestimmen, ob der Pfeil unterbrochen werden
muss oder nicht, kann mit Hilfe eines Parameters zur Feineinstellung (Teil des
Befehls \texttt{\textbackslash{}setupdivers}) manuell
vergrößert oder verkleinert werden, wenn die Ergebnisse suboptimal aussehen.

Dieses Beispiel zeigt auch die beiden unterschiedlichen Anordnungsoptionen für
die Abstiegssymbole und die Lagentransformation. Im ersten Schritt sind beide
auf gleicher Höhe ausgerichtet, das Abstiegssymbol ist dafür nicht mehr genau in
der Mitte zwischen lblockeins und lblockzwei. Im Fall des zweiten Abstiegs sind
rseins und lseins jeweils genau in der Mitte der Pfeile, aber dafür nicht bündig
auf einer Höhe. Das Verhalten läßt sich mittels der Schalter in
\texttt{\textbackslash{}setupdivers} einstellen.


\begin{figure}[btp]
\centering
\begin{stammbaum}

\setuplinks%
{true}% Raumgruppe und Summenformel 1
{2em}% Mindestlänge Linie/Pfeil 1
{true}% Abstiegssymbol 1
{true}% Raumgruppe und Summenformel 2
{2em}% Mindestlänge Linie/Pfeil 2
{true}% Abstiegssymbol 2
{true}% Raumgruppe und Summenformel 3
{0em}% zusätzliche vertikale Abstände
   
\setuprechts%
{true}% Lagentabelle 1
{2em}% Mindestlänge Linie/Pfeil 1
{true}% Transformation 1
{true}% Lagentabelle 2
{2em}% Mindestlänge Linie/Pfeil 2
{true}% Transformation 2
{true}% Lagentabelle 3
{0.5em}% zusätzliche vertikale Abstände

\setupdivers%
{3em}% horizontaler Abstand links <-> rechts
{-0.5em}% Feinabstimmung Kollisionskontrolle x
{0em}% Feinabstimmung Kollisionskontrolle y
{true}% lseins und rseins vertikal zentrieren
{false}% lszwei und rszwei vertikal zentieren
{false}% Randbox zeichnen
      
\setuprlagentabellen%
{4.5em}% Spaltenbreite
{2}% Anzahl Spalten Tabelle eins
{2}% Anzahl Spalten Tabelle zwei
{4}% Anzahl Spalten Tabelle drei  
{0em}% horizontale Verschiebung Tabelle eins
{0em}% horizontale Verschiebung Tabelle zwei
{0em}% horizontale Verschiebung Tabelle drei

\lverbindungeins{%
\begin{tabular}{c}%
$P6_3/m \, 2/c \, 2/m$\\[0.3em]
\fbox{hex. TiI$_3$}\\
\end{tabular}%
}

\labstiegeins{%
\begin{tabular}{c}
k3\\
$\mathbf{a-b, a+2b, c}$
\end{tabular}%
}

\lverbindungzwei{%
$P6_3/m \, 2/m \, 2/c$%\\
}

\labstiegzwei{%
t2%
}

\lverbindungdrei{%
\begin{tabular}{c}
$P\overline{3} \, 2/m \, 1$\\[0.3em]
\fbox{$\beta$-WCl$_6$}\\
\end{tabular}%
}

\rlagentranseins{%
$x,y,z$ (überflüssig)%
}

\rlagentranszwei{%
$x,y,z$ (sinnfrei) %
}

\rlagentabelleeins{%
\begin{tabularx}{\spaltenbreiteem*\spalteneins}[t]{|z|z|}
\hline
Ti: $2b$	  & $\Box$: $4d$ \\
$\overline{3}m$ & $3.2$ \\
\hline
0		  & \zd \\
0		  & \ed \\
0		  & 0 \\
\hline
\end{tabularx}%
}

\rlagentabellezwei{%
\begin{tabularx}{\spaltenbreiteem*\spaltenzwei}[t]{|z|z|}%
\hline
$2a$	    & $4f$ \\
$\overline{3}m$    &  $3m$ \\
\hline
0		    	  	 & \ed \\
0		    	  	 & \zd \\
0		      & 0.0 \\
\hline
\end{tabularx}%
}

\rlagentabelledrei{%
\begin{tabularx}{\spaltenbreiteem*\spaltendrei}[t]{|z|z|z|z|}
\hline
W1: $1a$	    & $\Box$: $1b$         & W2: $2d$  & $\Box$: $2d$\\
$\overline{3}m$    & $\overline{3}m$ & $3m$ & $3m$ \\
\hline
0		    & 0 	       & \ed  & \ed \\
0		    & 0 	       & \zd  & \zd \\
0		    & \eh   & 0.473 & 0.0 \\
\hline
\end{tabularx}%
}


\rechtspfeilsetup{
\rpfeileinszwei{1}{1}
\rpfeileinszwei{1}{2}
\rpfeilzweidrei{1}{1}
\rpfeilzweidrei{1}{2}
\rpfeilzweidrei{2}{3}
\rpfeilzweidrei{2}{4}
}
\end{stammbaum}

\caption{Etwas aufwändigerer Stammbaum mit Lagenfortführung und
(sinnfreier) Koordinatentransformation.}
\label{abb_mit_aufw}
\end{figure}

\end{document}

